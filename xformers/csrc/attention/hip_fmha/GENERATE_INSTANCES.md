# generate\_instances.py 

     generate\_instances.py is a simple tool used to generate several hundred of instances (.cpp files) and their references (.h files). 
  Without generate\_instances.py, manually writing those instances and references will be laborious and easy to get wrong. 

     The instances generated by this scripts are divided into three categories visible from the scripts: 

   * Infer -- which refers to instances for calling inference-only kernels
   * Forward -- which refers to instances for calling training forward kernels
   * Backward -- which refers to instances for calling training backward kernels

     generate\_instances.py is to be used by the HIP fmha developers themselves. It is not supposed to be used by the user/xformers developers for 
  building xformers, since for xformers users, the instances are already well prepared as part of the xformers codes. 

## how to use generate\_instances.py

   * To generate complete instances supported by current implementation

     ```bash
      #> python xformers/csrc/attention/hip_fmha/generate_instances.py
     ```
   
   * To generate reduced instances (when headdim256 is not required)

     ```bash
      #> python xformers/csrc/attention/hip_fmha/generate_instances.py --ignore-hd256
     ```
   * More options except for `--ignore-hd256` could be added to suppport further customization in generating instances as required

## where the instances files are located

   * The instances files (.cpp) and references files (.h) are always located under a folder `instances` that is located under the same directory
     as generate\_instances.py itself

     
